<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Driftframe twitch bot</title>
        <!-- https://electronjs.org/docs/tutorial/security#csp-meta-tag -->
        <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
    </head>
    <body>
        <ul id="racerList" style="list-style-type:none;">
            <li>
                <div>
                    <H2>Racer List</H2>
                </div>
            </li>
            <li>
                <div>
                    <p>You</p>
                </div>
            </li>
            <li slot = "1">
                <div>
                    <p></p>
                </div>
            </li>
            <li slot = "2">
                <div>
                    <p></p>
                </div>
            </li>
            <li slot = "3">
                <div>
                    <p></p>
                </div>
            </li>
        </ul>
    </body>
    <script>
        const {ipcRenderer} = require('electron'); 

        const racerListEl = document.getElementById("racerList");
        

        ipcRenderer.on("updateList", function(event, racers) {
            //TODO: improve alot
            for(let i = 0; i < 3; i++){
                let slot = racerListEl.querySelector(`[slot="${i+1}"]`);
                let racer = racers[i];
                slot.innerHTML = `<div><p>${racer ? racer.name : '<i>Open</i>'}</p></div>`
            }
            
        });
        
        ipcRenderer.send("queue:next");
    </script>
</html>
